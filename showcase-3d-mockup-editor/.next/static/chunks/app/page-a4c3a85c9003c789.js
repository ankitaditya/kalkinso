(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5013:function(e){function t(e){return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}t.keys=function(){return[]},t.resolve=t,t.id=5013,e.exports=t},6968:function(e,t,a){Promise.resolve().then(a.bind(a,912)),Promise.resolve().then(a.bind(a,1481)),Promise.resolve().then(a.bind(a,8032))},8032:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return R}});var r,n,s,o,l=a(7437),c=a(5854),i=a.n(c),p=()=>(0,l.jsx)("div",{className:i().spinner,"data-cy":"loading-spinner"}),d=a(6800),u=a.n(d),m=a(7354),f=a.n(m),_=e=>{let{options:t,value:a,name:r,label:n,buttonStyle:s,onChange:o,size:c="sm"}=e,i=e=>r+e.value;return(0,l.jsxs)("div",{className:f().wrapper,children:[n&&(0,l.jsx)("span",{className:f().description,children:n}),(0,l.jsx)("div",{className:f().optionWrapper,children:t.map(e=>{let t=e.value===a;return(0,l.jsx)("button",{style:s,className:u()(f().labelWrapper,f()["labelWrapper--"+c],{[f().labelWrapperActive]:t}),onClick:()=>!t&&o(e.value),children:e.label},i(e))})})]})},h=a(5611),g=a(2265),b=a(116),v=a.n(b),C=a(4410);function k(){return(k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var x=e=>C.createElement("svg",k({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},e),r||(r=C.createElement("path",{stroke:"#121A21",strokeLinecap:"square",strokeLinejoin:"round",strokeOpacity:.9,d:"M12.5 9.5v3h-3M6.5 3.5h-3v3",opacity:.75})),n||(n=C.createElement("path",{fill:"#121A21",fillOpacity:.9,fillRule:"evenodd",d:"M6.5 14H7v-1H4.06l2.97-2.97-1.06-1.06L3 11.94V9H2v4.5a.5.5 0 0 0 .5.5zM14 6.5V7h-1V4.06l-2.97 2.97-1.06-1.06L11.94 3H9V2h4.5a.5.5 0 0 1 .5.5zM13 3",clipRule:"evenodd"})));function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var j=e=>C.createElement("svg",w({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none"},e),s||(s=C.createElement("path",{stroke:"#121A21",strokeLinecap:"square",strokeLinejoin:"round",strokeOpacity:.9,d:"M14.5 17.5v-3h3M6.5 9.5h3v-3",opacity:.75})),o||(o=C.createElement("path",{fill:"#121A21",fillOpacity:.9,fillRule:"evenodd",d:"M17.5 11h.5v-1h-2.94l2.97-2.97-1.06-1.06L14 8.94V6h-1v4.5a.5.5 0 0 0 .5.5zM11 17.5v.5h-1v-2.94l-2.97 2.97-1.06-1.06L8.94 14H6v-1h4.5a.5.5 0 0 1 .5.5zM10 14",clipRule:"evenodd"})));a(1187);let y=e=>{let{imageUrl:t,modelUrl:a,baseColorTextureIndex:r,cameraOrbit:n="160deg 90deg"}=e,s=(0,g.useRef)(),[o,c]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{(async()=>{let e=s.current;if(!e||!e.model)return;let a=e.model.materials[r],n=await e.createTexture(t);a.pbrMetallicRoughness.baseColorTexture.setTexture(n)})()},[r,t]),(0,g.useEffect)(()=>{let e=s.current;e.addEventListener("load",async()=>{let a=e.model.materials[r],s=await e.createTexture(t);a.pbrMetallicRoughness.baseColorTexture.setTexture(s),e.cameraOrbit=n,e.cameraControls=!0,c(!0)})},[a,t,r,n]),(0,l.jsx)("model-viewer",{ref:s,src:a,style:{width:"100%",height:"100%"},"camera-controls":!0,"shadow-intensity":"1","data-cy":o?"mockup-3d-canvas":"mockup-3d-canvas-loading",children:(0,l.jsx)("div",{className:"progress-bar hide",slot:"progress-bar",children:(0,l.jsx)("div",{className:"update-bar"})})})};var S=a(3066);function W(e){let{config:t,configure:a,onInstanceChange:r,...n}=e,s=(0,g.useRef)(null);return(0,g.useEffect)(()=>{if(!s.current)return;let e=s.current,n=null,o=!1;return S.ZP.create(e,null!=t?t:{}).then(async e=>{if(o){e.dispose();return}n=e,a&&await a(n),r&&r(n)}),()=>{o=!0,null==n||n.dispose(),n=null,r&&r(void 0)}},[s,t,a,r]),(0,l.jsx)("div",{ref:s,...n})}let N=g.useMemo,O=g.useCallback,M=g.useState,T=g.useState,E={businesscard:{label:"Business Card",assetsFolderName:"business-card",sceneTitle:"Business Card Design",baseColorTextureIndex:0,cameraOrbit:"160deg 90deg"},cap:{label:"Baseball Cap",assetsFolderName:"cap",sceneTitle:"Baseball Cap Design",baseColorTextureIndex:0,cameraOrbit:"160deg 90deg"},apparel:{label:"Apparel",assetsFolderName:"t-shirt",sceneTitle:"T-Shirt Design",baseColorTextureIndex:1,cameraOrbit:"0deg 90deg"}},L="".concat("http://app.kalkinso.com").concat("","/cases/3d-mockup-editor/1x1-ffffffff.png"),F=(e,t,a)=>{e.block.findByName(t).forEach(t=>{let r=e.block.getFill(t);e.block.setString(r,"fill/image/imageFileURI",a),e.block.resetCrop(t)})};var R=()=>{let[e,t]=T(),[a,r]=M(),[n,s]=(0,g.useState)(),[o,c]=(0,g.useState)(""),[i,d]=(0,g.useState)(!0),[m,f]=(0,g.useState)(!1),[b,C]=(0,g.useState)(!1),[k,w]=(0,g.useState)(!0),S=new URLSearchParams(window.location.search).get("c_product")||"apparel",[R,U]=(0,g.useState)(S),I=(0,g.useRef)(R);(0,g.useEffect)(()=>{I.current=R},[R]),(0,g.useEffect)(()=>{let e=new URLSearchParams(window.location.search);e.set("c_product",R),window.history.pushState({},"","".concat(window.location.pathname,"?").concat(e))},[R]);let B=(0,g.useMemo)(()=>E[R],[R]);(0,g.useEffect)(()=>{let e;let a=!1;return h.ZP.init({license:"X5vxMMqS6wAzpWIk0cXhaQyvj5kx5NhrjbBWnFy05sh5UzCa6mKimNKT2FoFaFvP"}).then(async r=>{if(a){r.dispose();return}e=r,t(r)}),()=>{a=!0,e&&(e.dispose(),t(void 0))}},[t]);let P=(0,g.useCallback)(async()=>{if(m)return;f(!0),d(!0),await new Promise(e=>setTimeout(e,0));let t=[];for(let e of a.engine.block.findByType("page"))t=[...t,await a.engine.block.export(e,"image/png",{targetWidth:1048,targetHeight:1048})];n?await e.scene.loadFromString(n):await e.scene.loadFromURL("".concat("http://app.kalkinso.com").concat("","/cases/3d-mockup-editor/").concat(B.assetsFolderName,"/textures/Material_baseColor.scene"));for(let a=t.length;a<=10;a++)F(e,"Image ".concat(a+1),L);t.forEach((t,a)=>{F(e,"Image ".concat(a+1),URL.createObjectURL(t))});let r=e.scene.get(),o=await e.scene.saveToString(),l=await e.block.export(r,"image/jpeg");d(!1),f(!1),I.current===R&&(w(!1),s(o),c(URL.createObjectURL(l)))},[n,a,e,B]);(0,g.useEffect)(()=>{let t=setInterval(()=>{a&&k&&e&&P()},1500);return()=>clearInterval(t)},[k,a,e,P]);let A=N(()=>({license:"X5vxMMqS6wAzpWIk0cXhaQyvj5kx5NhrjbBWnFy05sh5UzCa6mKimNKT2FoFaFvP",role:"Adopter",callbacks:{onExport:"download",onUpload:"local"},ui:{elements:{navigation:{title:B.sceneTitle,action:{export:{show:!0,format:["image/png","application/pdf"]}}},panels:{settings:!0}}}}),[B]),D=O(async e=>{await e.addDefaultAssetSources(),await e.addDemoAssetSources({sceneMode:"Design"}),e.ui.setDockOrder([...e.ui.getDockOrder().filter(e=>{let{key:t}=e;return"ly.img.template"!==t})]),e.engine.editor.setSettingBool("page/title/show",!1),e.loadFromURL("".concat("http://app.kalkinso.com").concat("","/cases/3d-mockup-editor/").concat(B.assetsFolderName,"/design.scene"))},[B]);return(0,g.useEffect)(()=>{if(!a)return;let e=a.engine.editor.onHistoryUpdated(()=>{w(!0)});return()=>{e()}},[a]),(0,g.useEffect)(()=>{R&&(d(!0),s())},[R]),(0,l.jsxs)("div",{className:v().outerWrapper,children:[(0,l.jsx)("div",{className:v().productsWrapper,children:(0,l.jsx)(_,{options:Object.entries(E).map(e=>{let[t,{label:a}]=e;return{label:a,value:t}}),value:R,name:"product",onChange:e=>{U(e),c("")},size:"md"})}),(0,l.jsxs)("div",{className:v().wrapper,children:[(0,l.jsx)("div",{className:v().smokeScreen,style:{visibility:b?"visible":"hidden",opacity:b?"1":"0"}}),(0,l.jsx)("div",{className:u()({[v().fullscreenMockupCenter]:b}),onClick:e=>{b&&e.target===e.currentTarget&&C(!1)},children:(0,l.jsxs)("div",{className:u()({[v().fullscreenMockupWrapper]:b,[v().mockupWrapper]:!b}),children:[i&&(0,l.jsx)(p,{}),o&&(0,l.jsx)("div",{className:v().topBar,children:(0,l.jsx)("button",{className:v().button,onClick:()=>C(e=>!e),children:b?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(j,{})," Exit Fullscreen"]}):(0,l.jsx)(x,{})})}),o&&(0,l.jsx)(y,{isInteractive:b,imageUrl:o,modelUrl:"".concat("http://app.kalkinso.com").concat("","/cases/3d-mockup-editor/").concat(B.assetsFolderName,"/scene.gltf"),baseColorTextureIndex:B.baseColorTextureIndex,cameraOrbit:B.cameraOrbit})]})}),(0,l.jsx)("div",{className:"cesdkWrapperStyle",children:(0,l.jsx)(W,{className:"cesdkStyle",config:A,configure:D,onInstanceChange:r})})]})]})}},116:function(e){e.exports={header:"CaseComponent_header__PDNrD",previewImage:"CaseComponent_previewImage__uOjL2",smokeScreen:"CaseComponent_smokeScreen__c_RLZ",fullscreenMockupCenter:"CaseComponent_fullscreenMockupCenter__HfnlB",fullscreenMockupWrapper:"CaseComponent_fullscreenMockupWrapper__iB074",modal:"CaseComponent_modal__9nTdk",button:"CaseComponent_button__V9gsW","button--primary":"CaseComponent_button--primary__T0dEy","button--solid":"CaseComponent_button--solid__m6OSm",topBar:"CaseComponent_topBar__f9afu",mockupWrapper:"CaseComponent_mockupWrapper__1g7Q5",cesdk:"CaseComponent_cesdk__7aJ0I",cesdkWrapper:"CaseComponent_cesdkWrapper__l1jOi",productsWrapper:"CaseComponent_productsWrapper__vIePa",outerWrapper:"CaseComponent_outerWrapper__ttLB1",wrapper:"CaseComponent_wrapper___u_ji"}},5854:function(e){e.exports={spinner:"LoadingSpinner_spinner__CFYJL",rotation:"LoadingSpinner_rotation__52mmD"}},7354:function(e){e.exports={wrapper:"SegmentedControl_wrapper__gUfGY",description:"SegmentedControl_description__wsOex",labelWrapper:"SegmentedControl_labelWrapper__4Quvn","labelWrapper--sm":"SegmentedControl_labelWrapper--sm__nypHY","labelWrapper--md":"SegmentedControl_labelWrapper--md__84TnW",labelWrapperActive:"SegmentedControl_labelWrapperActive__nCSBT",label:"SegmentedControl_label__bumNn",input:"SegmentedControl_input__9LxaY",optionWrapper:"SegmentedControl_optionWrapper__rUQsH"}}},function(e){e.O(0,[768,534,890,141,74,971,23,744],function(){return e(e.s=6968)}),_N_E=e.O()}]);